# Build MDI Setup Packages #
Spoon Virtual Application Studio enables you to generate Microsoft Windows Installer (MSI) setup packages. In addition to deploying virtual application executable files to the host file-system, Spoon Virtual Application Studio-generated MSI packages enable you to create desktop and Start Menu shortcuts, set up shell file extension associations for virtualized applications, and clean up applications with Control Panel uninstallers.

## Configure Package Information ##
This section describes MSI package configuration options, which are located in the MSI section of Setup.
Setting MSI Package Location
The MSI package generated by Spoon Virtual Application Studio writes to the file specified in Output Location. This textbox contains the full name of the output file, including  output path and MSI file name.
By default, MSI packages do not automatically generate or update when a virtual application is rebuilt. To automatically update MSI packages after a virtual application rebuild, choose Automatically generate MSI after successful application build. Generating MSIs on every build can be time consuming, so it may be better to disable this option during the virtual application development process.
You can manually regenerate the MSI package by selecting the Build MSI button.
Note: You must build the virtual application executable before the MSI package can generate. The Build MSI button is disabled if the virtual application is not yet built.
Specifying Package Metadata
MSI setup packages contain a manifest describing the product name, version, and manufacturer. To configure the MSI package metadata, enter the appropriate values for Product Info.
Note: The metadata published on MSI packages is distinct from the metadata published on virtual application executables. To modify executable shell metadata, specify the appropriate metadata under Settings.
Installation Parameters
Installation Parameters enable configuration of options such as install location and permissions parameters.
Applications can be installed for current users or for all users. To install the application for all users, select the Install applications for All Users box.
Note: Installing applications for all users requires privileged access to the host device. Do not enable this option if the MSI package is designed for use by end-users with standard permissions.
The Application Folder specifies the location where the application is installed. The standard form is: \<Application Data>\<Company Name>\<Product Name>. These values are populated by the Product Info data by default.
If you run the setup package on a device which already has a version of the application installed, the MSI package can be designed to update the existing application version, or perform a side-by-side installation with the existing application version. 
To automatically update existing versions, select the Automatically upgrade earlier application versions option; to use side-by-side installation, select the Allow side-by-side versions of the same application option.
Note: Building with the Allow side-by-side versions of the same application option enabled causes a new setup package GUID to be generated. Once a build is completed with this option enabled, previous installations are no longer upgraded in place, even if you revert to Automatically upgrade earlier application versions mode.
Extended Properties

## Configure Shortcuts ##
Desktop, Start Menu, and Send to shortcuts enable you to launch virtual applications directly from the Windows shell as if they were native applications. Shortcuts created during the snapshot process of a normal install will automatically be picked up in the configuration. When deploying applications with Spoon Server, shortcuts are designated as Entry Points when the SVM package is uploaded to the Spoon Server.
Complete the following steps to manually configure shortcuts for a virtual application:
Select Setup.
Expand Shortcuts and choose one of the following three destinations: Desktop (displays shortcuts which appear on the desktop); Programs Menu (displays shortcuts that appear in Start Menu > Programs); SendTo (displays shortcuts that appear when you Right-Click > Send To on a file or folder).
Select Add Shortcut to add a shortcut to the selected destination.
Enter the shortcut Name.
Set the Target drop-down to the desired application entry point for the shortcut. This drop-down is populated with the startup file list, enabling shortcuts to quickly connect to jukebox entry points. Select Edit List to make a quick change.
Configure the Arguments, Show As, and Description fields.
Select Browse to associate a shortcut with an icon. Locate the .ico, .dll, or .exe file that contains the icon and select Open. Choose the correct icon from Icon Browser.
Select OK to finish adding the shortcut.
Select Add Folder to add a shortcut folder to the selected destination. Use folders to organize shortcuts. You can remove or modify a shortcut by selecting it from the tree view and choosing Edit Shortcut or Remove.
Virtual application shortcuts appear on the Desktop, Start Menu, and Send to locations once the application is registered to the Microsoft Windows shell. You can completed registration using the Spoon plugin, SpoonReg utility, or an MSI install.
Note:  For MSI installations, the Start Menu items appear in the current user's Start Menu or in all users' Start Menus, depending on the Install application for All Users setting in the MSI installation parameters section. This setting is located under MSI in Setup.

## Creating File Associations ##

File associations enable viewer or editor applications to automatically launch when you double-clicks on a document in the Microsoft Windows shell. For example, a .doc file can automatically launch a virtualized word-processing application. File associations created during the snapshot process of a normal install will automatically be picked up in the configuration.
Complete the following steps to create a file association:
Under Setup, select ProgIds and choose Add ProgId. 
Enter a ProgId and Description in the Create ProgId dialog. The general naming convention is: [Company Name].[Product Name].[Version]. 
In the new ProgId, select Add Verb and enter a Verb, Command and choose Inherit Behavior and Default. 
Select Extensions and choose Add Extension. Enter an Extension, a ProgId and an optional MIME Type.
Some common verbs are open, edit, print, and view. The Verb entered is the text that displays when the user right-clicks on a file. When Inherit is checked, the behavior of the Verb is controlled by the setup information in the virtual environment. When Inherit is unchecked, a Target startup file and Arguments must be entered manually. The Arguments field should contain "%1". When Default is checked, Verb is automatically executed when the file is double-clicked.
File association properties can be modified or deleted by selecting the appropriate ProgId under Setup.
